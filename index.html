<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯¾å ‚éšæœºç‚¹åç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            color: #333;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .header {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            padding: 30px 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        
        .header h1 {
            font-size: 32px;
            margin-bottom: 8px;
            position: relative;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            opacity: 0.9;
            font-size: 17px;
            position: relative;
        }
        
        .main-content {
            padding: 35px;
        }
        
        .student-display {
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 50px 30px;
            text-align: center;
            margin-bottom: 35px;
            border: 3px dashed #d0d7e2;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.05);
        }
        
        .student-display.rolling {
            animation: pulse-bg 0.8s infinite alternate;
        }
        
        @keyframes pulse-bg {
            from { background: linear-gradient(to right, #f8f9fa, #e9ecef); }
            to { background: linear-gradient(to right, #e9ecef, #dde1e7); }
        }
        
        .student-name {
            font-size: 56px;
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 15px;
            min-height: 70px;
            transition: all 0.2s ease;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .student-id {
            font-size: 22px;
            color: #5a6c7d;
            background-color: rgba(255, 255, 255, 0.7);
            padding: 8px 20px;
            border-radius: 30px;
            display: inline-block;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 18px 35px;
            font-size: 19px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            min-width: 180px;
        }
        
        .btn:active {
            transform: translateY(3px);
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
        }
        
        .btn-start {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
        }
        
        .btn-start:hover:not(:disabled) {
            background: linear-gradient(to right, #2980b9, #2573a7);
            transform: translateY(-4px);
            box-shadow: 0 10px 18px rgba(41, 128, 185, 0.3);
        }
        
        .btn-stop {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
        }
        
        .btn-stop:hover:not(:disabled) {
            background: linear-gradient(to right, #c0392b, #a93226);
            transform: translateY(-4px);
            box-shadow: 0 10px 18px rgba(192, 57, 43, 0.3);
        }
        
        .btn-reset {
            background: linear-gradient(to right, #2ecc71, #27ae60);
            color: white;
        }
        
        .btn-reset:hover:not(:disabled) {
            background: linear-gradient(to right, #27ae60, #219653);
            transform: translateY(-4px);
            box-shadow: 0 10px 18px rgba(39, 174, 96, 0.3);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1) !important;
        }
        
        .btn-icon {
            font-size: 22px;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-box {
            flex: 1;
            min-width: 180px;
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #4b6cb7;
            transition: transform 0.3s ease;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 16px;
            color: #7f8c8d;
        }
        
        .history-container {
            background-color: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .history-header {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .history-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px 5px;
        }
        
        .history-item {
            background-color: white;
            padding: 12px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
            border-left: 5px solid #3498db;
            min-width: 180px;
            transition: transform 0.2s ease;
        }
        
        .history-item:hover {
            transform: translateY(-3px);
        }
        
        .history-name {
            font-weight: bold;
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .history-details {
            font-size: 14px;
            color: #7f8c8d;
            display: flex;
            justify-content: space-between;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #95a5a6;
            font-size: 15px;
            border-top: 1px solid #eee;
            background-color: #f8f9fa;
        }
        
        .highlight {
            color: #e74c3c;
            font-weight: bold;
            animation: highlight-pulse 1s infinite alternate;
        }
        
        @keyframes highlight-pulse {
            from { text-shadow: 0 0 5px rgba(231, 76, 60, 0.5); }
            to { text-shadow: 0 0 15px rgba(231, 76, 60, 0.8), 0 0 20px rgba(231, 76, 60, 0.4); }
        }
        
        .empty-history {
            color: #95a5a6;
            text-align: center;
            width: 100%;
            padding: 30px;
            font-style: italic;
        }
        
        /* æ»šåŠ¨æ¡æ ·å¼ */
        .history-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .history-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .history-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
        
        .history-list::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 26px;
            }
            
            .student-name {
                font-size: 40px;
            }
            
            .btn {
                padding: 16px 25px;
                font-size: 17px;
                min-width: 160px;
            }
            
            .stat-box {
                min-width: 140px;
            }
            
            .stat-value {
                font-size: 30px;
            }
            
            .main-content {
                padding: 25px 20px;
            }
        }
        
        @media (max-width: 600px) {
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .stats {
                flex-direction: column;
            }
            
            .student-name {
                font-size: 34px;
            }
            
            .student-id {
                font-size: 18px;
            }
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>è¯¾å ‚éšæœºç‚¹åç³»ç»Ÿ</h1>
            <p>åŸºäº students.xlsx åå• Â· å…¬å¹³éšæœº Â· è®°å½•å®Œæ•´å†å²</p>
        </div>
        
        <div class="main-content">
            <div class="student-display" id="studentDisplay">
                <div class="student-name" id="studentName">ç­‰å¾…ç‚¹å</div>
                <div class="student-id" id="studentId">ç‚¹å‡»å¼€å§‹æŒ‰é’®éšæœºé€‰æ‹©å­¦ç”Ÿ</div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-start" id="startBtn">
                    <span class="btn-icon">â–¶</span>
                    <span>å¼€å§‹éšæœºç‚¹å</span>
                </button>
                <button class="btn btn-stop" id="stopBtn" disabled>
                    <span class="btn-icon">â¹</span>
                    <span>åœæ­¢å¹¶é€‰ä¸­</span>
                </button>
                <button class="btn btn-reset" id="resetBtn">
                    <span class="btn-icon">â†»</span>
                    <span>é‡ç½®è®°å½•</span>
                </button>
            </div>
            
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-value" id="calledCount">0</div>
                    <div class="stat-label">å·²ç‚¹åæ¬¡æ•°</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="remainingCount">48</div>
                    <div class="stat-label">å‰©ä½™å­¦ç”Ÿæ•°</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="totalCount">48</div>
                    <div class="stat-label">æ€»å­¦ç”Ÿæ•°</div>
                </div>
            </div>
            
            <div class="history-container">
                <div class="history-header">
                    <span>ğŸ“‹ ç‚¹åå†å²è®°å½•</span>
                </div>
                <div class="history-list" id="historyList">
                    <div class="empty-history">æš‚æ— ç‚¹åè®°å½•ï¼Œç‚¹å‡»å¼€å§‹æŒ‰é’®è¿›è¡Œç‚¹å</div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>åŸºäº students.xlsx åå• | å…±48åå­¦ç”Ÿ | éšæœºç‚¹åç³»ç»Ÿ | å¿«æ·é”®: ç©ºæ ¼é”®å¼€å§‹/åœæ­¢, Ctrl+Ré‡ç½®</p>
        </div>
    </div>

    <script>
        // å­¦ç”Ÿæ•°æ® - æ¥è‡ªæ‚¨æä¾›çš„Excelè¡¨æ ¼
        const students = [
            { id: 1, name: "åˆ˜æœå½§", studentId: "2024106005" },
            { id: 2, name: "éƒ‘èˆ’å¿ƒ", studentId: "2024106011" },
            { id: 3, name: "ç™½å®‡æ›¦", studentId: "2024106015" },
            { id: 4, name: "å¼ åª›åª›", studentId: "2024106021" },
            { id: 5, name: "äºæ¢¦æ¬¢", studentId: "2024106025" },
            { id: 6, name: "å¼ æ¢¦å®‡", studentId: "2024106029" },
            { id: 7, name: "è€¿é“‚æ¶µ", studentId: "2024106031" },
            { id: 8, name: "é‚±æ€€ç‘¾", studentId: "2024106034" },
            { id: 9, name: "æå¯“æ¬£", studentId: "2024106036" },
            { id: 10, name: "æœç­±æ›¼", studentId: "2024106040" },
            { id: 11, name: "å¼ å»¶è“‰", studentId: "2024106042" },
            { id: 12, name: "åˆ˜å¨±è²", studentId: "2024106043" },
            { id: 13, name: "ç‹ææ€¡", studentId: "2024106046" },
            { id: 14, name: "æå­é»˜", studentId: "2024106047" },
            { id: 15, name: "ææ˜±æ½¼", studentId: "2024106053" },
            { id: 16, name: "æå† é¢‰", studentId: "2024106054" },
            { id: 17, name: "æä½³ç‘¶", studentId: "2024106068" },
            { id: 18, name: "é‚¹ä½³å½¤", studentId: "2024106069" },
            { id: 19, name: "å¼ æ›¦æœˆ", studentId: "2024106071" },
            { id: 20, name: "é›·æ¹˜", studentId: "2024106073" },
            { id: 21, name: "æ¨é›ªç´", studentId: "2024106074" },
            { id: 22, name: "ç¨‹èµŸè²", studentId: "2024106075" },
            { id: 23, name: "å¼ ç‹ç‰", studentId: "2024106077" },
            { id: 24, name: "æ¨æœ¬é’°", studentId: "2024106078" },
            { id: 25, name: "é«˜é™æ€¡", studentId: "2024106079" },
            { id: 26, name: "æä¸¹", studentId: "2024106080" },
            { id: 27, name: "æ±ªåŸ¹", studentId: "2024106081" },
            { id: 28, name: "é©¬èŠ™è“‰", studentId: "2024106083" },
            { id: 29, name: "å¼ è‹¥å…®", studentId: "2024106084" },
            { id: 30, name: "ç‹æ­Œç’‡", studentId: "2024106085" },
            { id: 31, name: "ç‹è’™", studentId: "2024106086" },
            { id: 32, name: "ææ¬£", studentId: "2024106087" },
            { id: 33, name: "å·¦æ˜é¢–", studentId: "2024106088" },
            { id: 34, name: "å´æ˜•æ˜±", studentId: "2024106089" },
            { id: 35, name: "å¼ ä¸¹", studentId: "2024106090" },
            { id: 36, name: "æ ¼æ¡‘æ‹‰å§†", studentId: "2024106093" },
            { id: 37, name: "æç¥æ½¼", studentId: "2024106094" },
            { id: 38, name: "æ¨ä¸½", studentId: "2024106097" },
            { id: 39, name: "é©¬å›½æ£®", studentId: "2024106098" },
            { id: 40, name: "ç‹æ€€ç‰", studentId: "2024106099" },
            { id: 41, name: "åˆ˜å­˜å¸…", studentId: "2024106100" },
            { id: 42, name: "ç¬¦ä½³è±ª", studentId: "2024106103" },
            { id: 43, name: "å­™æ¢“å¿", studentId: "2024106104" },
            { id: 44, name: "é©¬æ™¨çš“", studentId: "2024106112" },
            { id: 45, name: "å¼ æ´›é—»", studentId: "2024106113" },
            { id: 46, name: "æ‰è¥¿", studentId: "2024106115" },
            { id: 47, name: "æ›¹é‘«é‘«", studentId: "2024106116" },
            { id: 48, name: "å¸•å°”å“ˆææ±ŸÂ·éº¦å›¾èª", studentId: "2024106118" }
        ];

        // ç³»ç»ŸçŠ¶æ€
        let remainingStudents = [...students];
        let calledStudents = [];
        let isRolling = false;
        let rollInterval;
        let currentStudent = null;

        // DOMå…ƒç´ 
        const studentNameElement = document.getElementById('studentName');
        const studentIdElement = document.getElementById('studentId');
        const studentDisplayElement = document.getElementById('studentDisplay');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const resetBtn = document.getElementById('resetBtn');
        const calledCountElement = document.getElementById('calledCount');
        const remainingCountElement = document.getElementById('remainingCount');
        const totalCountElement = document.getElementById('totalCount');
        const historyListElement = document.getElementById('historyList');

        // åˆå§‹åŒ–
        function init() {
            totalCountElement.textContent = students.length;
            updateCounters();
            renderHistory();
            
            // æ·»åŠ åˆå§‹åŠ¨ç”»
            studentNameElement.classList.add('fade-in');
            setTimeout(() => {
                studentNameElement.classList.remove('fade-in');
            }, 500);
        }

        // æ›´æ–°è®¡æ•°å™¨
        function updateCounters() {
            calledCountElement.textContent = calledStudents.length;
            remainingCountElement.textContent = remainingStudents.length;
            
            // å¦‚æœæ‰€æœ‰å­¦ç”Ÿéƒ½è¢«ç‚¹è¿‡äº†ï¼Œæ˜¾ç¤ºæç¤º
            if (remainingStudents.length === 0) {
                studentNameElement.textContent = "æ‰€æœ‰å­¦ç”Ÿå·²ç‚¹åå®Œæ¯•";
                studentIdElement.textContent = "ç‚¹å‡»é‡ç½®æŒ‰é’®é‡æ–°å¼€å§‹";
                studentNameElement.classList.add('highlight');
                studentNameElement.classList.remove('fade-in');
                void studentNameElement.offsetWidth; // è§¦å‘é‡ç»˜
                studentNameElement.classList.add('fade-in');
            }
        }

        // éšæœºé€‰æ‹©å­¦ç”Ÿ
        function getRandomStudent() {
            if (remainingStudents.length === 0) return null;
            const randomIndex = Math.floor(Math.random() * remainingStudents.length);
            return remainingStudents[randomIndex];
        }

        // å¼€å§‹éšæœºç‚¹å
        function startRolling() {
            if (remainingStudents.length === 0) {
                alert("æ‰€æœ‰å­¦ç”Ÿéƒ½å·²è¢«ç‚¹åï¼Œè¯·é‡ç½®åé‡è¯•ï¼");
                return;
            }
            
            isRolling = true;
            startBtn.disabled = true;
            stopBtn.disabled = false;
            studentNameElement.classList.remove('highlight');
            studentDisplayElement.classList.add('rolling');
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            studentNameElement.classList.remove('fade-in');
            void studentNameElement.offsetWidth; // è§¦å‘é‡ç»˜
            studentNameElement.classList.add('fade-in');
            
            // å¿«é€Ÿåˆ‡æ¢å­¦ç”Ÿï¼Œæ¨¡æ‹Ÿéšæœºæ•ˆæœ
            rollInterval = setInterval(() => {
                currentStudent = getRandomStudent();
                if (currentStudent) {
                    studentNameElement.textContent = currentStudent.name;
                    studentIdElement.textContent = `å­¦å·: ${currentStudent.studentId}`;
                    
                    // æ·»åŠ å¾®å¦™çš„åŠ¨ç”»æ•ˆæœ
                    studentNameElement.classList.remove('fade-in');
                    void studentNameElement.offsetWidth; // è§¦å‘é‡ç»˜
                    studentNameElement.classList.add('fade-in');
                }
            }, 80); // æ¯80æ¯«ç§’åˆ‡æ¢ä¸€æ¬¡
        }

        // åœæ­¢å¹¶é€‰ä¸­å½“å‰å­¦ç”Ÿ
        function stopRolling() {
            if (!isRolling) return;
            
            clearInterval(rollInterval);
            isRolling = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            studentDisplayElement.classList.remove('rolling');
            
            if (currentStudent) {
                // ä»å‰©ä½™å­¦ç”Ÿä¸­ç§»é™¤
                const index = remainingStudents.findIndex(s => s.id === currentStudent.id);
                if (index !== -1) {
                    remainingStudents.splice(index, 1);
                }
                
                // æ·»åŠ åˆ°å·²ç‚¹ååˆ—è¡¨
                const now = new Date();
                const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
                
                calledStudents.unshift({
                    ...currentStudent,
                    time: timeString
                });
                
                // æ›´æ–°æ˜¾ç¤º
                studentNameElement.textContent = currentStudent.name;
                studentIdElement.textContent = `å­¦å·: ${currentStudent.studentId}`;
                studentNameElement.classList.add('highlight');
                
                // æ·»åŠ é€‰ä¸­åŠ¨ç”»
                studentNameElement.classList.remove('fade-in');
                void studentNameElement.offsetWidth;
                studentNameElement.classList.add('fade-in');
                
                // æ›´æ–°è®¡æ•°å™¨å’Œå†å²è®°å½•
                updateCounters();
                renderHistory();
                
                // æ’­æ”¾æç¤ºéŸ³
                playSelectSound();
            }
        }

        // é‡ç½®ç³»ç»Ÿ
        function resetSystem() {
            clearInterval(rollInterval);
            isRolling = false;
            startBtn.disabled = false;
            stopBtn.disabled = true;
            studentDisplayElement.classList.remove('rolling');
            
            remainingStudents = [...students];
            calledStudents = [];
            currentStudent = null;
            
            studentNameElement.textContent = "ç­‰å¾…ç‚¹å";
            studentIdElement.textContent = "ç‚¹å‡»å¼€å§‹æŒ‰é’®éšæœºé€‰æ‹©å­¦ç”Ÿ";
            studentNameElement.classList.remove('highlight');
            
            // æ·»åŠ é‡ç½®åŠ¨ç”»
            studentNameElement.classList.remove('fade-in');
            void studentNameElement.offsetWidth;
            studentNameElement.classList.add('fade-in');
            
            updateCounters();
            renderHistory();
            
            // æ’­æ”¾é‡ç½®æç¤ºéŸ³
            playResetSound();
        }

        // æ¸²æŸ“å†å²è®°å½•
        function renderHistory() {
            historyListElement.innerHTML = '';
            
            if (calledStudents.length === 0) {
                historyListElement.innerHTML = '<div class="empty-history">æš‚æ— ç‚¹åè®°å½•ï¼Œç‚¹å‡»å¼€å§‹æŒ‰é’®è¿›è¡Œç‚¹å</div>';
                return;
            }
            
            calledStudents.forEach((student, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item fade-in';
                historyItem.style.animationDelay = `${index * 0.05}s`;
                historyItem.innerHTML = `
                    <div class="history-name">${student.name}</div>
                    <div class="history-details">
                        <span>${student.studentId}</span>
                        <span>${student.time}</span>
                    </div>
                `;
                historyListElement.appendChild(historyItem);
            });
        }

        // æ’­æ”¾é€‰æ‹©æç¤ºéŸ³
        function playSelectSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("éŸ³é¢‘æ’­æ”¾å¤±è´¥ï¼Œä½†ä¸å½±å“åŠŸèƒ½");
            }
        }

        // æ’­æ”¾é‡ç½®æç¤ºéŸ³
        function playResetSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 600;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } catch (e) {
                console.log("éŸ³é¢‘æ’­æ”¾å¤±è´¥ï¼Œä½†ä¸å½±å“åŠŸèƒ½");
            }
        }

        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener('click', startRolling);
        stopBtn.addEventListener('click', stopRolling);
        resetBtn.addEventListener('click', resetSystem);

        // åˆå§‹åŒ–ç³»ç»Ÿ
        init();
        
        // æ·»åŠ é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', (e) => {
            // ç©ºæ ¼é”®å¼€å§‹/åœæ­¢
            if (e.code === 'Space') {
                e.preventDefault();
                if (isRolling) {
                    stopRolling();
                } else {
                    startRolling();
                }
            }
            
            // Ré”®é‡ç½®
            if (e.code === 'KeyR' && e.ctrlKey) {
                e.preventDefault();
                resetSystem();
            }
        });
        
        // æ·»åŠ é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŠ¨ç”»
        window.addEventListener('load', () => {
            document.querySelector('.container').style.opacity = '0';
            document.querySelector('.container').style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                document.querySelector('.container').style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                document.querySelector('.container').style.opacity = '1';
                document.querySelector('.container').style.transform = 'translateY(0)';
            }, 100);
        });
    </script>
</body>
</html>